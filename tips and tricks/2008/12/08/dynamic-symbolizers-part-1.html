<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Dynamic Symbolizers (Part 1)</title>
    <meta name="viewport" content="width=device-width">
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,800" rel="stylesheet" type="text/css">

    <link rel="stylesheet" href="/css/bootstrap-3.0.3.min.css">
    <link rel="stylesheet" href="/css/ol.css"/>
    <link rel="stylesheet" href="/css/app.css">
    <link rel="alternate" type="application/atom+xml" title="Atom feed" href="/feed.xml">

    <link rel="shortcut icon" href="/favicon.ico">
  </head>

  <body >
      <nav class="navbar" role="navigation">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" 
              data-target="#gs-navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">GeoServer</a>
    </div>

    <div class="collapse navbar-collapse" id="gs-navbar-collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
          <a href="/about">About</a>
        </li>
        <li>
          <a href="/blog" target="_blank">Blog</a>
        </li>        
        <li>
          <a href="/download">Download</a>
        </li>
        <li>
          <a href="http://docs.geoserver.org">Documentation</a>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Community <b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="/comm">Community Support</a></li>
            <li><a href="/support">Commercial Support</a></li>
            <li><a href="/issues">Issue Tracker</a></li>
            <li><a href="/devel">Community Development</a></li>
            <li><a href="/roadmap">Roadmap</a></li>
            <li><a href="https://github.com/geoserver/geoserver/wiki/Home" target="_blank">Wiki</a></li>
            <li><a href="https://github.com/geoserver/geoserver/graphs/contributors">Contributors</a></li>
            <li><a href="https://github.com/geoserver/geoserver/blob/master/CODE_OF_CONDUCT.md">Code of Conduct</a></li>
            <li><a href="/license">License</a></li>
          </ul>
        </li>
      </ul>
    </div>
    <a href="https://github.com/geoserver/geoserver" target="_blank">
      <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"></a>
  </nav>

      <div class="background">
        <div class="post-body">
          <div class="wrapper /tips%20and%20tricks/2008/12/08/dynamic-symbolizers-part-1">
            <div class="content">
              <div class="post">

                <header class="post-header">
                  <h1 class="post-title">Dynamic Symbolizers (Part 1)</h1>
                  <p class="post-meta">Dec 8, 2008 • aaime</p>
                </header>

                <article class="post-content">
                  <p>When <a href="http://geoserver.org/display/GEOS/GeoServer+1.7.0">GeoServer 1.7.0</a> was released in October of 2008, it included some new features that many people might find useful.  One of those new features is support for <strong>dynamic symbolizers.</strong></p>

<p>Dynamic symbolizers, which originated from a <a href="http://geotools.codehaus.org/Dynamic+SLD+Graphic+objects">GeoTools styling subsystem improvement</a> from this past summer, allows you to do three things:</p>

<ul>
  <li>
    <p>Create external references that contain feature attributes as variables__</p>
  </li>
  <li>
    <p>Use decorative true type fonts as markers in your map</p>
  </li>
  <li>
    <p>Program your own dynamic symbolizer to extend existing ones, with full access to all of the current feature attributes</p>
  </li>
</ul>

<p>In this post we’ll cover the first item, and in the next post we’ll consider the other two.</p>

<p>**Dynamic Symbolizers With External References
**</p>

<p>Say you want to make a map of the USA that shows each state’s flag superimposed on the state.  (You can use the <em>topp:states</em> layer, which comes standard with GeoServer.)  With the old symbolizer approach, you would have to do two things:</p>

<ul>
  <li>
    <p>Find all the flags as images, possibly as small PNG/GIF images.</p>
  </li>
  <li>
    <p>Write a different rule for each state, connecting each state with its respective flag.</p>
  </li>
</ul>

<p>Now, having to find the flags is a challenge, but it can be done.   <a href="http://www.usautoparts.net/bmw/media/icons/states.htm">This site</a>, for example, has small flag graphics in JPEG format. The really time-consuming part is writing 50 different rules, each matching a state with its flag.</p>

<p>If we look closely at the image names, we can see a pattern.  The file names are all of the form:</p>

<p>tn_<StateAbbreviation>.jpg</StateAbbreviation></p>

<p>And we happen to have the same state abbreviations in the STATE_ABBR attribute. Wouldn’t it be great if we could just link the attribute to the external graphics link?</p>

<p>With dynamic symbolizers, this can be done. You can embed <a href="http://geotools.codehaus.org/CQL+Parser+Design">CQL</a> (Common Query Language) expressions inside a external graphics link or inside a well-known mark name, and have the expression be expanded dynamically.  To embed a CQL expression, all you have to do is to type it between the brackets in this form:  ${ }.</p>

<p>Let’s apply this to our case. The external graphics link might originally look like:</p>

<blockquote>

&gt;     
&gt;     <ExternalGraphic>
&gt;        <OnlineResource xlink:type="simple" xlink:href="http://www.usautoparts.net/bmw/images/states/tn_${STATE_ABBR}.jpg" />
&gt;        <Format>image/gif</Format>
&gt;     </ExternalGraphic>
&gt; 
&gt; 
</blockquote>

<p>Note the file name:  tn_${STATE_ABBR}.jpg.  For each feature, the attribute name will be expanded, generating a different link for every feature. Unfortunately, that’s still not good enough, because the abbreviations are upper case, and the site links are case-sensitive and require lower case names. However, as we mentioned above, you can leverage the full power of CQL expressions in the dynamic symbolizer elements.  In this case, we can use the strToLowerCase function to change the values of our attributes to lower case.  With that, we have an instant flag map.</p>

<p><a href="/img/uploads/usaflags1.png"><img src="/img/uploads/usaflags1.png" alt="Sample USA states maps with flags" /></a><a href="/img/uploads/usaflags1.png"></a></p>

<p>Here is the full SLD to generate this at home.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;span class="cp"&gt;&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;&lt;/span&gt;
&lt;span class="nt"&gt;&lt;StyledLayerDescriptor&lt;/span&gt; &lt;span class="na"&gt;version=&lt;/span&gt;&lt;span class="s"&gt;"1.0.0"&lt;/span&gt;
  &lt;span class="na"&gt;xmlns=&lt;/span&gt;&lt;span class="s"&gt;"http://www.opengis.net/sld"&lt;/span&gt;
  &lt;span class="na"&gt;xmlns:ogc=&lt;/span&gt;&lt;span class="s"&gt;"http://www.opengis.net/ogc"&lt;/span&gt;
  &lt;span class="na"&gt;xmlns:xlink=&lt;/span&gt;&lt;span class="s"&gt;"http://www.w3.org/1999/xlink"&lt;/span&gt;
  &lt;span class="na"&gt;xmlns:xsi=&lt;/span&gt;&lt;span class="s"&gt;"http://www.w3.org/2001/XMLSchema-instance"&lt;/span&gt;
  &lt;span class="na"&gt;xsi:schemaLocation=&lt;/span&gt;&lt;span class="s"&gt;"http://www.opengis.net/sld&lt;/span&gt;
&lt;span class="s"&gt;                      http://schemas.opengis.net/sld/1.0.0/StyledLayerDescriptor.xsd"&lt;/span&gt;&lt;span class="nt"&gt;&gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&lt;NamedLayer&gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&lt;Name&gt;&lt;/span&gt;Default Polygon&lt;span class="nt"&gt;&lt;/Name&gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&lt;UserStyle&gt;&lt;/span&gt;
      &lt;span class="nt"&gt;&lt;Title&gt;&lt;/span&gt;Flags of USA&lt;span class="nt"&gt;&lt;/Title&gt;&lt;/span&gt;
      &lt;span class="nt"&gt;&lt;FeatureTypeStyle&gt;&lt;/span&gt;
        &lt;span class="nt"&gt;&lt;Rule&gt;&lt;/span&gt;
          &lt;span class="nt"&gt;&lt;Name&gt;&lt;/span&gt;Solid black outline&lt;span class="nt"&gt;&lt;/Name&gt;&lt;/span&gt;
          &lt;span class="nt"&gt;&lt;LineSymbolizer&gt;&lt;/span&gt;
            &lt;span class="nt"&gt;&lt;Stroke/&gt;&lt;/span&gt;
          &lt;span class="nt"&gt;&lt;/LineSymbolizer&gt;&lt;/span&gt;
        &lt;span class="nt"&gt;&lt;/Rule&gt;&lt;/span&gt;
      &lt;span class="nt"&gt;&lt;/FeatureTypeStyle&gt;&lt;/span&gt;
      &lt;span class="nt"&gt;&lt;FeatureTypeStyle&gt;&lt;/span&gt;
        &lt;span class="nt"&gt;&lt;Rule&gt;&lt;/span&gt;
          &lt;span class="nt"&gt;&lt;Name&gt;&lt;/span&gt;Flags&lt;span class="nt"&gt;&lt;/Name&gt;&lt;/span&gt;
          &lt;span class="nt"&gt;&lt;Title&gt;&lt;/span&gt;USA state flags&lt;span class="nt"&gt;&lt;/Title&gt;&lt;/span&gt;
          &lt;span class="nt"&gt;&lt;PointSymbolizer&gt;&lt;/span&gt;
            &lt;span class="nt"&gt;&lt;Graphic&gt;&lt;/span&gt;
              &lt;span class="nt"&gt;&lt;ExternalGraphic&gt;&lt;/span&gt;
                &lt;span class="nt"&gt;&lt;OnlineResource&lt;/span&gt; &lt;span class="na"&gt;xlink:type=&lt;/span&gt;&lt;span class="s"&gt;"simple"&lt;/span&gt;
                  &lt;span class="na"&gt;xlink:href=&lt;/span&gt;&lt;span class="s"&gt;"http://www.usautoparts.net/bmw/images/states/tn_${strToLowerCase(STATE_ABBR)}.jpg"&lt;/span&gt; &lt;span class="nt"&gt;/&gt;&lt;/span&gt;
                &lt;span class="nt"&gt;&lt;Format&gt;&lt;/span&gt;image/gif&lt;span class="nt"&gt;&lt;/Format&gt;&lt;/span&gt;
              &lt;span class="nt"&gt;&lt;/ExternalGraphic&gt;&lt;/span&gt;
            &lt;span class="nt"&gt;&lt;/Graphic&gt;&lt;/span&gt;
          &lt;span class="nt"&gt;&lt;/PointSymbolizer&gt;&lt;/span&gt;
        &lt;span class="nt"&gt;&lt;/Rule&gt;&lt;/span&gt;
      &lt;span class="nt"&gt;&lt;/FeatureTypeStyle&gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&lt;/UserStyle&gt;&lt;/span&gt;
  &lt;span class="nt"&gt;&lt;/NamedLayer&gt;&lt;/span&gt;
&lt;span class="nt"&gt;&lt;/StyledLayerDescriptor&gt;&lt;/span&gt;
</code></pre></div></div>

                </article>

            </div>
          </div>
        </div>
        <div class="sidebar">
          <script>
            function toggleContents(target) {
              if (target.classList.contains('toggled')) {
                target.classList.remove('toggled')
              } else {
                target.classList.add('toggled')
              }
            }
          </script> 
          <div class="sidebar-category" onclick="toggleContents(this)" />
            <h4>&nbsp;Announcements</h4>
            <ul>
              
                <li><a href="/announcements/2022/05/24/geoserver-2-21-0-released.html">GeoServer 2.21.0 Release</a></li>
                
              
                <li><a href="/announcements/2022/05/09/geoserver-2-21-RC-released.html">GeoServer 2.21-RC Release Candidate</a></li>
                
              
                <li><a href="/announcements/vulnerability/2022/04/11/geoserver-2-20-4-released.html">GeoServer 2.20.4 Released</a></li>
                
              
                <li><a href="/announcements/2022/04/11/geoserver-2-19-6-released.html">GeoServer 2.19.6 Released</a></li>
                
              
                <li><a href="/announcements/2022/04/11/geoserver-2-18-6-released.html">GeoServer 2.18.6 Released</a></li>
                
              
                <li><a href="/announcements/vulnerability/2022/03/08/geoserver-2-20-3-released.html">GeoServer 2.20.3 Released</a></li>
                
              
                <li><a href="/announcements/vulnerability/2022/03/08/geoserver-2-19-5-released.html">GeoServer 2.19.5 Released</a></li>
                
              
                <li><a href="/announcements/2022/01/24/geoserver-2-20-2-released.html">GeoServer 2.20.2 Released</a></li>
                
              
                <li><a href="/announcements/vulnerability/2021/12/22/geoserver-2-19-4-released.html">GeoServer 2.19.4 Released</a></li>
                
              
                <li><a href="/announcements/2021/11/22/geoserver-2-20-1-released.html">GeoServer 2.20.1 Released</a></li>
                
                  
            </ul>
          </div>
          
          <!-- 2017 -->
          
            
            
            
              
            
            
            
            
            
            
          
            
            
            
            
            
              
            
            
            
            
            
            
          
            
            
            
            
            
              
            
            
            
            
            
              
            
            
            
            
            
              
            
            
            
            
            
            
          
            
            
            
            
            
              
            
            
            
            
            
            
          
          
          
          
            
            
            
            <div class="sidebar-category" onclick="toggleContents(this)" />
              <h4>&nbsp;Vulnerability</h4>
              <ul>
                
                  
                  
                  
                  <li><a href="/vulnerability/2022/04/11/geoserver-2-jiffle-jndi-rce.html">Jiffle and GeoTools RCE vulnerabilities</a></li>
                  
                
                  
                  
                  
                  <li><a href="/announcements/vulnerability/2022/04/11/geoserver-2-20-4-released.html">GeoServer 2.20.4 Released</a></li>
                  
                
                  
                  
                  
                  <li><a href="/vulnerability/2022/04/01/spring.html">Spring4Shell RCE vulnerability</a></li>
                  
                
                  
                  
                  
                  <li><a href="/announcements/vulnerability/2022/03/08/geoserver-2-20-3-released.html">GeoServer 2.20.3 Released</a></li>
                  
                
                  
                  
                  
                  <li><a href="/announcements/vulnerability/2022/03/08/geoserver-2-19-5-released.html">GeoServer 2.19.5 Released</a></li>
                  
                
                  
                  
                  
                  <li><a href="/announcements/vulnerability/2021/12/22/geoserver-2-19-4-released.html">GeoServer 2.19.4 Released</a></li>
                  
                
                  
                  
                  
                  <li><a href="/vulnerability/2021/12/13/logj4-rce-statement.html">Log4J2 zero day vulnerability assessment</a></li>
                  
                
                  
                  
                  
                  <li><a href="/announcements/vulnerability/2019/11/28/geoserver-2-16-1-released.html">GeoServer 2.16.1 released</a></li>
                  
                
                  
                  
                  
                  <li><a href="/announcements/vulnerability/2018/09/24/geoserver-2-14-0-released.html">GeoServer 2.14.0 Released</a></li>
                  
                
                  
                  
                  
                  <li><a href="/announcements/vulnerability/2018/08/24/geoserver-2-12-5-released.html">GeoServer 2.12.5 released</a></li>
                  
                    
              </ul>
            </div>
          
            
            
            
            <div class="sidebar-category" onclick="toggleContents(this)" />
              <h4>&nbsp;Behind The Scenes</h4>
              <ul>
                
                  
                  
                  
                  <li><a href="/behind%20the%20scenes/2022/01/20/log4j-upgrade.html">Log4j1 update or replace activity</a></li>
                  
                
                  
                  
                  
                  <li><a href="/behind%20the%20scenes/2017/04/27/geoserver-monthly-bug-stomp.html">GeoServer monthly bug stomp</a></li>
                  
                
                  
                  
                  
                  <li><a href="/behind%20the%20scenes/2017/04/11/rest-api-code-sprint-results.html">REST API Code Sprint Results</a></li>
                  
                
                  
                  
                  
                  <li><a href="/behind%20the%20scenes/2017/01/23/geoserver-code-sprint-2017.html">GeoServer Code Sprint 2017</a></li>
                  
                
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
              </ul>
            </div>
          
            
            
            
            <div class="sidebar-category" onclick="toggleContents(this)" />
              <h4>&nbsp;Developer notes</h4>
              <ul>
                
                  
                  
                  
                  <li><a href="/developer%20notes/2021/03/04/main-branch.html">GeoServer repository transition to main branch</a></li>
                  
                
                  
                  
                  
                  <li><a href="/developer%20notes/2018/08/27/foss4g-2018-geoserver-developers-workshop.html">FOSS4G 2018 GeoServer Developers Workshop</a></li>
                  
                
                  
                  
                  
                  <li><a href="/developer%20notes/2017/06/13/geoserver-at-foss4g-2017-boston.html">GeoServer at FOSS4G 2017 Boston</a></li>
                  
                
                  
                  
                  
                  <li><a href="/developer%20notes/2017/03/09/rest-api-code-sprint-prep.html">REST API Code Sprint Prep</a></li>
                  
                
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
              </ul>
            </div>
          
            
            
            
            <div class="sidebar-category" onclick="toggleContents(this)" />
              <h4>&nbsp;Tutorials</h4>
              <ul>
                
                  
                  
                  
                  <li><a href="/tutorials/2019/09/03/geoserver-presentations-on-foss4g-2019.html">GeoServer Presentations on FOSS4G 2019</a></li>
                  
                
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
              </ul>
            </div>
          
        </div>
      </div>
      <div id="footer">
    <span class="left"><a href="/feed.xml"><img alt="Atom feed" src="/img/rss-icon.png" height="16" width="16">Atom feed</a></span>
    <span class="right">
        &copy;2022 <a href="https://www.osgeo.org/">Open Source Geospatial Foundation</a>. License <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution</a>.
    </span>
</div>

    </div>
        <script src="/js/jquery-1.11.1.min.js"></script>
    <script src="/js/bootstrap-3.0.3.min.js"></script>
    <script src="/js/ol.js"></script>
    <script src="/js/app.js"></script>
    <script>
    $(document).ready(function() {
        if (typeof window.init != "undefined") {
          init();
        }
    });
    </script>
    
  </body>
</html>
